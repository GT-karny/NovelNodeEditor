# ユーザーガイド

NovelNodeEditorはReact Flowベースのシーンノードエディタです。このガイドでは、アプリケーションの主要な操作手順とトラブルシューティングのヒントをまとめています。

## 1. 画面構成と初期状態

- 上部: 新規作成、保存、読み込み、ノード追加などの操作ボタンを配置したツールバー。
- 中央: ノードを配置・接続するキャンバス。
- 右側: 選択中ノードの詳細を編集するサイドバー。初回起動時は「はじめのノード」が1つ配置され、サイドバーには未選択状態の案内が表示されます。

## 2. ツールバーの操作

| ボタン | 説明 |
| ------ | ---- |
| 新規 | ノードとエッジを初期状態に戻し、ローカルストレージ内の保存データも削除します。 |
| 保存 | 現在のシーン構成を `novel-node-editor-flow` というキーでブラウザのローカルストレージへ保存します。 |
| 読み込み | 保存済みデータがあればローカルストレージから読み込み、キャンバスへ復元します。 |
| ノード追加 | 連番タイトルと初期位置を持つ新しいノードをキャンバス中央付近に追加します。 |

## 3. キャンバス上での操作

- **ノード移動と接続**: ノードはドラッグで移動できます。ノード上下のハンドル同士をドラッグ＆ドロップすると接続線を作成できます。
- **コンテキストメニュー**: キャンバスを右クリックするとメニューが開き、選択位置にノードを追加できます。ノードを右クリックすると「シーン内容」「削除」などの項目が表示されます。
- **ノード選択**: ノードをクリックすると選択状態になり、サイドバーでタイトルと概要を編集できます。キャンバスの空白をクリックすると選択解除されます。
- **ノード編集**: ノードをダブルクリック、またはコンテキストメニューから「シーン内容」を選ぶとインライン編集フォームが開き、保存するとタイトルが更新されます。
- **ノード削除**: ノードのコンテキストメニューから削除を選ぶと、そのノードと接続中のエッジが削除されます。
- **エッジ削除**: 接続線を右クリックし、確認ダイアログでOKを選ぶと削除されます。
- **サイドバーの表示切替**: キャンバス右上のトグルボタンでサイドバーを開閉できます。閉じている場合はノード選択時の自動フォーカスが無効になります。
- **ズームとパン**: キャンバス左下のコントローラやスクロール／ドラッグ操作でズーム・パンが可能です。

## 4. 保存データとローカルストレージ

保存データはブラウザのローカルストレージ内 `novel-node-editor-flow` にJSON形式で記録されます。初期化したい場合はアプリの「新規」ボタンを押すか、ブラウザの開発者ツールから該当キーを削除してください。

## 5. トラブルシューティング

- **保存したデータが読み込めない**: データ破損の可能性があります。ローカルストレージから `novel-node-editor-flow` を削除し、シーンを再構築・保存してください。
- **ノードが選択できない／入力欄にフォーカスしない**: サイドバーが閉じていないか確認してください。閉じている場合は右上のトグルボタンで再表示し、必要に応じてノードを再選択します。
- **誤って接続したエッジを削除したい**: エッジを右クリックして確認ダイアログでOKを選択すると削除できます。

